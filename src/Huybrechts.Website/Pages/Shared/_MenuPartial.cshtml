@using Huybrechts.Website.Data
@using Microsoft.AspNetCore.Identity
@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager

@{
	var applicationUser = await UserManager.GetUserAsync(User);
}

<nav class="navbar navbar-expand-sm navbar-toggleable-sm navbar-light bg-transparent box-shadow mb-3">
	<div class="container float">
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target=".navbar-collapse" aria-controls="navbarSupportedContent"
				aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>
		@if (SignInManager.IsSignedIn(User) && applicationUser is not null)
		{
			<div class="navbar-collapse collapse d-sm-inline-flex flex-sm-row-reverse">
				<div class="dropdown">
					<button class="btn btn-secondary dropdown-toggle" type="button" id="userMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						<img src="@applicationUser.ImageData32" height="32" width="32" class="rounded-circle" alt="User Icon">
					</button>
					<div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
						<a class="dropdown-item nav-link btn btn-link text-dark" asp-area="Identity" asp-page="/Account/Manage/Index" title="Manage">Hello @applicationUser.FirstName!</a>
						<form class="form-inline" asp-area="Identity" asp-page="/Account/Logout" asp-route-returnUrl="@Url.Action("Index", "Home", new { area = "" })">
							<button type="submit" class="nav-link btn btn-link text-dark">Logout</button>
						</form>
						<div class="dropdown-divider" aria-labelledby="dropdownMenuButton"></div>
						@if (User.IsInRole(ApplicationRole.Administrator))
						{
						}
						<!--<a class="dropdown-item nav-link btn btn-link text-dard" href="/healthchecks-ui" title="Health Checks">Health check</a>-->
					</div>
				</div>
			</div>
		}
		else
		{
			<div class="navbar-collapse collapse d-sm-inline-flex flex-sm-row-reverse">
				<ul class="navbar-nav">
					<li class="nav-item">
						<a class="nav-link d-flex align-items-center" asp-area="Identity" asp-page="/Account/Login" routerLinkActive="active">
							<img src="~/img/community.png" height="32" width="32" class="iconos" alt="Logo">
							<h5 class="my-0">Community Login</h5>
						</a>
					</li>
				</ul>
			</div>
		}
	</div>
</nav>
